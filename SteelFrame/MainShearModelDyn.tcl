wipe;
source DynSettings.tcl;
model BasicBuilder -ndm 2 -ndf 3;
set story 9;
node 0 0 0;
fix 0 1 1 1;
set mass {503.40000000000003 495.0 495.0 495.0 495.0 495.0 495.0 495.0 532.8}
set s1p {9532249.591617709 14086153.212939205 12524988.803542614 12197366.165852966 9900705.642492369 9570165.201758293 7849552.077350267 7945661.160022579 7088963.845060137}
set e1p {36.31487588508663 23.11884253018879 20.511693183322325 24.284308360152174 20.9954548634468 25.39629433192815 22.55305385454122 26.459562530030244 22.476135702635574}
set s2p {10892038.0 16399870.0 16861720.0 13901128.0 13115349.0 10915051.0 10163156.0 9168542.0 9236204.0}
set e2p {319.971 319.988 319.991 319.99 319.988 319.994 319.997 319.998 319.999}
set s3p {10432138.756520173 15813370.537642082 14346480.782044224 13798631.922807477 11442742.253822556 10883440.038491363 8911965.785322873 9091467.21099024 7942300.9908970995}
set e3p {320.29097099999996 320.30798799999997 320.63098199999996 320.62998 320.627976 320.313994 320.31699699999996 320.31834163208055 320.47704521251245}
set s1n {-9450056.988774734 -13954597.907617323 -12270973.086496191 -12146582.331236461 -9751751.825512424 -9545430.033461085 -7700794.967022465 -7948357.27241539 -6889246.914083158}
set e1n {-35.74701971693958 -23.076271219119022 -19.67808080299732 -24.364138578820153 -20.949938151816944 -25.37167532364627 -21.747318697778162 -26.301746996262562 -21.859933538998973}
set s2n {-10891962.0 -16399840.0 -16861690.0 -13901120.0 -13115335.0 -10915074.0 -10163163.0 -9168542.0 -9236210.0}
set e2n {-320.029 -320.012 -320.009 -320.01 -320.012 -320.006 -320.003 -320.002 -320.001}
set s3n {-10651898.172943559 -9189533.182469914 -2740785.999701895 -13878512.666791687 -11582869.1640624 -10915074.0 -778788.6064076937 -2516089.5304909535 -9236210.0}
set e3n {-320.349029 -320.33201199999996 -320.649018 -320.33000999999996 -320.4114167369031 -320.646012 -320.3609577993448 -320.45081507054374 -320.42288940676616}
set pinchX {0.001017487267992139 0.0012740511488890244 0.00597020042887391 0.0012032405764756267 0.001 0.001 0.0013327113696089386 0.04131280488474532 0.008910085058374406}
set pinchY {0.7154227582115503 0.6497921198233217 0.5084400816878183 0.6758412687312328 0.5177285612230561 0.672769028924217 0.5333817223044011 0.6873579224432659 0.5308398645565466}
set damage1 {0.0010653974553549682 0.0010500044410071932 0.0010307163167536813 0.001 0.001 0.001 0.001029606819419406 0.001 0.0010310426053142883}
set damage2 {0.0011654879034533137 0.0012698591897297889 0.0010114746540486707 0.001000001551678256 0.001 0.0010022571107989803 0.003412548223751002 0.0011094495010953067 0.001097907466413474}
set beta {0.05029159678218345 0.0011152048998953222 0.02489131457754873 0.0016172189946318972 0.026363417688708465 0.003828624238787499 0.035826449064334236 0.013278113036829943 0.04352551925617413}
set height {5486.4 9448.8 13411.199999999999 17373.6 21336.0 25298.4 29260.800000000003 33223.200000000004 37185.600000000006}
for {set i 0} {$i < $story} {incr i} {
node [expr $i + 1] 0 [lindex $height $i];
mass [expr $i + 1] [lindex $mass $i] 0 0;
fix [expr $i + 1] 0 1 1;
uniaxialMaterial Hysteretic [expr $i + 1] [lindex $s1p $i] [lindex $e1p $i] [lindex $s2p $i] [lindex $e2p $i] [lindex $s3p $i] [lindex $e3p $i] \
[lindex $s1n $i] [lindex $e1n $i] [lindex $s2n $i] [lindex $e2n $i] [lindex $s3n $i] [lindex $e3n $i] \
[lindex $pinchX $i] [lindex $pinchY $i] [lindex $damage1 $i] [lindex $damage2 $i] [lindex $beta $i];
element twoNodeLink [expr $i + 1] $i [expr $i + 1] -mat [expr $i + 1] [expr $i + 1] [expr $i + 1] -dir 1 2 3;
};
set xDamp 0.05;
set nEigenI 1;
set nEigenJ 2;
set lambdaN [eigen -fullGenLapack [expr $nEigenJ]];
set lambdaI [lindex $lambdaN [expr $nEigenI - 1]];
set lambdaJ [lindex $lambdaN [expr $nEigenJ - 1]];
set omegaI [expr pow($lambdaI, 0.5)];
set omegaJ [expr pow($lambdaJ, 0.5)];
set alphaM [expr $xDamp * (2 * $omegaI * $omegaJ) / ($omegaI + $omegaJ)];
set betaKcurr [expr 2. * $xDamp / ($omegaI + $omegaJ)];
rayleigh $alphaM $betaKcurr 0 0;
timeSeries Path 2 -dt $dt -filePath $path_GMR -factor $factor;
pattern UniformExcitation 2 1 -accel 2;
file mkdir $dataDir;
for {set i 0} {$i < $story} {incr i} {
recorder Node -file $dataDir/Dyn_[expr $i + 1]_disp.out -time -node [expr $i + 1] -dof 1 disp;
recorder Node -file $dataDir/Dyn_[expr $i + 1]_vel.out -time -node [expr $i + 1] -dof 1 vel;
recorder Node -file $dataDir/Dyn_[expr $i + 1]_accel.out -timeSeries 2 -time -node [expr $i + 1] -dof 1 accel;
};
constraints Transformation;
numberer Plain;
system BandGeneral;
integrator Newmark 0.5 0.25;
source SmartAnalyze.tcl;
SmartAnalyzeTransient $dt $npts;
