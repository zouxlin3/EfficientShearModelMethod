wipe;
set dataDir F:/data_RSRP/SteelFrame/ShearModelModal;
model BasicBuilder -ndm 2 -ndf 3;
set story 9;
node 0 0 0;
fix 0 1 1 1;
set mass {503.40000000000003 495.0 495.0 495.0 495.0 495.0 495.0 495.0 532.8}
set s1p {11252639.521000147 13979173.398918422 12638447.167474324 12197532.271013515 9901813.152593745 9694100.37266195 7806790.492640353 7981995.525231464 7065138.6082623135}
set e1p {51.80775031677599 22.657095790028016 21.16130913536226 24.66573687218247 21.989857462215923 25.005903847561807 23.514358619803694 26.0761705470133 23.36953554106344}
set s2p {13641920.015759628 17041820.0 17430790.0 14381579.0 13521188.0 11237680.0 10412292.0 9334218.0 9327995.0}
set e2p {320.0 320.0 320.0 320.0 320.0 320.0 320.0 320.0 320.0}
set s3p {12441223.395759214 16026897.427229581 14733064.775872556 13937301.06410796 11518504.171280727 11149259.40473388 9041699.303909736 9228842.757361505 8002948.886063747}
set e3p {320.39685897379786 320.31999999999994 320.31999999999994 320.31999999999994 320.34513218398246 320.64 320.4068668857169 320.31999999999994 320.57021341890174}
set s1n {-11180701.883356594 -13933445.588484745 -12344992.889991667 -12169038.426790832 -9720115.802850107 -9638437.347869731 -7637654.372583407 -7974691.703642439 -6893685.99258625}
set e1n {-51.65512947757655 -22.290769333177266 -20.467435928033364 -23.940200445470275 -21.69947450718703 -24.820797743870525 -22.693615481339823 -26.30529830211631 -23.076757923607563}
set s2n {-13642299.99999917 -17041820.0 -17430790.0 -14381579.0 -13521188.0 -11237680.0 -10412292.0 -9334218.0 -9327995.0}
set e2n {-320.0 -320.0 -320.0 -320.0 -320.0 -320.0 -320.0 -320.0 -320.0}
set s3n {-1042528.3684870327 -16875228.508153442 -11714118.059726655 -11222299.878158778 -966.7792219717594 -11237680.0 -6541899.1012616195 -4314108.878573356 -8584363.18841069}
set e3n {-320.31999999999994 -320.3423534513786 -320.31999999999994 -320.31999999999994 -320.31999999999994 -320.64 -320.31999999999994 -320.31999999999994 -320.63125432014976}
set pinchX {0.0010799673591033415 0.029397823540336966 0.001 0.0010173221548862802 0.0010024793396535819 0.001 0.0010615770608017761 0.011706736889179791 0.002009778958490266}
set pinchY {0.6654292133489668 0.6219558954571879 0.4682601497138533 0.650045325893108 0.4929459880943961 0.6366073628428567 0.5129950867176989 0.6587532829149441 0.5192715525130144}
set damage1 {0.001 0.001 0.001 0.0011498704162324353 0.001 0.0010036030994974583 0.001 0.0010582349818198775 0.001}
set damage2 {0.001 0.0015450809994238973 0.0012393521244286423 0.004003556508760788 0.001 0.001 0.0010002512082909424 0.0012978999511840293 0.0010070583806680372}
set beta {0.0011331183805081682 0.0037439560270200946 0.0014503515405194386 0.002811133584807011 0.0013866195930549103 0.007832030769957582 0.0014035930180542218 0.003595568112774456 0.010720362212289575}
set height {5486.4 9448.8 13411.199999999999 17373.6 21336.0 25298.4 29260.800000000003 33223.200000000004 37185.600000000006}
for {set i 0} {$i < $story} {incr i} {
node [expr $i + 1] 0 [lindex $height $i];
mass [expr $i + 1] [lindex $mass $i] 0 0;
fix [expr $i + 1] 0 1 1;
uniaxialMaterial Hysteretic [expr $i + 1] [lindex $s1p $i] [lindex $e1p $i] [lindex $s2p $i] [lindex $e2p $i] [lindex $s3p $i] [lindex $e3p $i] \
[lindex $s1n $i] [lindex $e1n $i] [lindex $s2n $i] [lindex $e2n $i] [lindex $s3n $i] [lindex $e3n $i] \
[lindex $pinchX $i] [lindex $pinchY $i] [lindex $damage1 $i] [lindex $damage2 $i] [lindex $beta $i];
element twoNodeLink [expr $i + 1] $i [expr $i + 1] -mat [expr $i + 1] [expr $i + 1] [expr $i + 1] -dir 1 2 3;
};

file mkdir $dataDir;
source Units.tcl;
set lambda [eigen -fullGenLapack 5];
set lambda1 [lindex $lambda 0];
set lambda2 [lindex $lambda 1];
set lambda3 [lindex $lambda 2];
set lambda4 [lindex $lambda 3];
set lambda5 [lindex $lambda 4];
set omega1 [expr pow($lambda1, 0.5)];
set omega2 [expr pow($lambda2, 0.5)];
set omega3 [expr pow($lambda3, 0.5)];
set omega4 [expr pow($lambda4, 0.5)];
set omega5 [expr pow($lambda5, 0.5)];
set T1 [expr 2 * $PI / $omega1];
set T2 [expr 2 * $PI / $omega2];
set T3 [expr 2 * $PI / $omega3];
set T4 [expr 2 * $PI / $omega4];
set T5 [expr 2 * $PI / $omega5];
set f1 [expr 1 / $T1];
set f2 [expr 1 / $T2];
set f3 [expr 1 / $T3];
set f4 [expr 1 / $T4];
set f5 [expr 1 / $T5];
puts "T1= $T1 s";
puts "T2= $T2 s";
puts "T3= $T3 s";
puts "T4= $T4 s";
puts "T5= $T5 s";
puts "f1= [expr 1 / $T1] Hz";
puts "f2= [expr 1 / $T2] Hz";
puts "f3= [expr 1 / $T3] Hz";
puts "f4= [expr 1 / $T4] Hz";
puts "f5= [expr 1 / $T5] Hz";
puts "w1= [expr $omega1] rad/s";
puts "w2= [expr $omega2] rad/s";
puts "w3= [expr $omega3] rad/s";
puts "w4= [expr $omega4] rad/s";
puts "w5= [expr $omega5] rad/s";

set fileT [open $dataDir/ParamsModal.txt w];
puts $fileT "T (s): $T1, $T2, $T3, $T4, $T5";
puts $fileT "f (Hz): $f1, $f2, $f3, $f4, $f5";
puts $fileT "w (rad/s): $omega1, $omega2, $omega3, $omega4, $omega5";
close $fileT;
recorder Node -file $dataDir/Eigen1.txt -node 1 2 -dof 1 "eigen 1";
recorder Node -file $dataDir/Eigen2.txt -node 1 2 -dof 1 "eigen 2";
recorder Node -file $dataDir/Eigen3.txt -node 1 2 -dof 1 "eigen 3";
recorder Node -file $dataDir/Eigen3.txt -node 1 2 -dof 1 "eigen 4";
recorder Node -file $dataDir/Eigen3.txt -node 1 2 -dof 1 "eigen 5";
record;
puts "Successfully Finished!";